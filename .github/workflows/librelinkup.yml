name: LibreLinkUp to Nightscout

on:
  workflow_dispatch:
  schedule:
    - cron: "*/5 * * * *"

concurrency:
  group: librelinkup-nightscout
  cancel-in-progress: true

jobs:
  librelinkup:
    runs-on: ubuntu-latest
    steps:
      - name: Run LibreLinkUp bridge (Docker)
        run: |
          docker run --rm \
            -e LINK_UP_USERNAME="${{ secrets.LINK_UP_USERNAME }}" \
            -e LINK_UP_PASSWORD="${{ secrets.LINK_UP_PASSWORD }}" \
            -e LINK_UP_REGION="${{ secrets.LINK_UP_REGION }}" \
            -e NIGHTSCOUT_URL="${{ secrets.NIGHTSCOUT_URL }}" \
            -e NIGHTSCOUT_API_TOKEN="${{ secrets.NIGHTSCOUT_API_TOKEN }}" \
            -e LINK_UP_TIME_INTERVAL="${{ secrets.LINK_UP_TIME_INTERVAL }}" \
            timoschlueter/nightscout-librelink-up:latest
